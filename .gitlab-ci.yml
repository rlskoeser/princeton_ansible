---
image: quay.io/ansible/molecule:2.22rc3
services:
  - docker:dind

stages:
  - tests

variables:
  ROLE_DIR: "pulibrary.apache2"


before_script:
  - docker -v
  - python -V
  - ansible --version
  - molecule --version

pulibrary-roles:
  stage: tests
  variables:
    DOCKER_HOST: "tcp://docker:2375"
    PY_COLORS: 1
  script:
    - cd roles/$ROLE_DIR
    - molecule test
